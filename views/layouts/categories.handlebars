<main>
  <section id="categories">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h1 class="heading">Categories</h1>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="action-btns">
            <div class="row">
              <div class="col-md-2">
                <a href="/add-category" class="action-btn">+ Add category</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <table class="table table-hover albums-table">
            <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th class="actions">Actions</th>
            </tr>
            </thead>
            <tbody>
            {{#if categories}}
              {{#each categories}}
                <tr>
                  <th scope="row"></th>
                  <td>
                    {{name}}
                  </td>
                  <td class="actions">
                    <a href="/categories/{{_id}}" style="display: none;">Edit</a>
                    <a href="/categories/{{_id}}" class="deleteCategoryBtn">Delete</a>
                  </td>
                </tr>
              {{/each}}
            {{/if}}
            </tbody>
          </table>
          <script>
            $(function () {
              const deleteCategoryBtn = $('.deleteCategoryBtn');

              deleteCategoryBtn.on('click', (e) => {
                console.log(this);
                e.preventDefault();
                console.dir(e.target.pathname);
                $.ajax({
                  method: 'DELETE',
                  url: e.target.pathname
                }).done(() => {
                  window.location.href = '/categories';
                }).fail(err => {
                  console.log('ERROR: ' + JSON.stringify(err.message));
                });
              })
            });
          </script>
        </div>
      </div>

    </div>
  </section>
</main>
